define([],function(){"use strict";function e(e){var n=t()||null;"no-storage"!==n&&(v=GU.util.merge(v,e),h.lowFricContainer=document.createElement("div"),h.lowFricContainer.classList.add("participation-low-fric"),h.articleBody=document.querySelector(".article__body > .prose"),i({selectedItem:n}),o())}function t(){if(!window.localStorage)return"no-storage";var e=GU.opts.pageId,t=JSON.parse(GU.util.getLocalStorage(w));return t&&t[e]}function i(e){n(GU.util.merge(m,e))}function n(e){var t;e.initialRender?(h.lowFricContainer.innerHTML='<h2 class="participation-low-fric__title">'+v.templateVars.title+'</h2><p class="participation-low-fric__desc">'+v.templateVars.description+'</p><div class="participation-low-friction__contents"><p class="review-rating"></p></div>',t=h.lowFricContainer.querySelector(".review-rating"),r(t),h.articleBody.appendChild(h.lowFricContainer)):t=h.lowFricContainer.querySelector(".review-rating"),a(t),e.selectedItem&&t.classList.add(e.selectedItem)}function r(e){var t,i="";for(t=0;t<v.itemCount;t++)i+='<span data-icon="&#xe036;" aria-hidden="true" class="participation-low-fric--button"></span>';e.innerHTML=i}function a(e){var t,i;for(i=e.classList.length;i>0;i--)t=e.classList[i-1],-1!==t.indexOf("review-rating--")&&e.classList.remove(t)}function o(){var e,t,i=h.lowFricContainer.querySelector(".participation-low-friction__contents"),n=h.lowFricContainer.querySelectorAll(".participation-low-fric--button");for(e=0;e<n.length;e++)t="review-rating--"+(e+1),n[e].addEventListener("click",l.bind(null,t)),L.push(n[e].offsetLeft);i.addEventListener("touchmove",GU.util.debounce(c,10)),i.addEventListener("touchend",GU.util.debounce(u,10))}function l(e){i({initialRender:!1,selectedItem:e}),d()}function c(e){var t=L[L.length-1],i=e.targetTouches[0].pageX;g||(g=i),g>t&&i>t||s(i)}function s(e){var t,n;for(t=0;t<L.length;t++)e>L[t]&&(n="review-rating--"+(t+1));i({initialRender:!1,selectedItem:n||null})}function u(){g&&d(),g=null}function d(){var e=GU.opts.pageId,t=JSON.parse(GU.util.getLocalStorage(w));t||(t={}),t[e]=m.selectedItem,GU.util.setLocalStorage(w,JSON.stringify(t)),p()}function p(){var e=h.lowFricContainer.querySelector(".participation-low-friction__test-message");e||(e=document.createElement("DIV"),e.classList.add("participation-low-friction__test-message"),e.innerHTML=v.templateVars.testMessage,h.lowFricContainer.appendChild(e),setTimeout(f.bind(null,e),250))}function f(e){e.classList.add("show-message")}var g,w="gu.lowFricParticipation",m={initialRender:!0,selectedItem:null},v={itemCount:5,templateVars:{title:"Do you agree? Rate this film now",description:"Let us know what you think!",testMessage:"Thanks for voting. This is a test. We're currently evaluating this as a potential new feature."}},h={},L=[];return{init:e}});